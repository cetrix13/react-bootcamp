<!DOCTYPE html>
<html>
<head>
  <title>First React App</title>
  <script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
  <script src='https://unpkg.com/babel-standalone@6/babel.min.js'></script>
</head>
<body>
  <div id='root'></div>

  <script type='text/babel'>
    class App extends React.Component {
      constructor(props) {
        super(props);
        this.state = {
          list: [
          { name: 'Fleisch', active: true },
          { name: 'Eie', active: true },
          { name: 'Obst', active: false },
          { name: 'GemÃ¼se', active: true }],
          input: '',
        };
        this.handleRemoveItem = this.handleRemoveItem.bind(this);
        this.updateInput = this.updateInput.bind(this);
        this.handleAddItem = this.handleAddItem.bind(this);
        this.handleClearAll = this.handleClearAll.bind(this);
        this.handleToDeactivate = this.handleToDeactivate.bind(this);
      }
      /**
       * Adds grocery item to the list
       */
      handleAddItem() {
        if (this.state.input.trim() !== "") {
        this.setState((currentState) => {
          return {
            list: currentState.list.concat([{name: currentState.input, active: true}]),
            input: '',
          }
        });
        }
      }
      /**
       * Removes grocery item from the list
       * @param {string} item
       */
      handleRemoveItem(item) {
        this.setState((currentState) => {
          return {
            list: currentState.list.filter((el) => el.name !== item )
          }
        }
        );
      }
      /**
       * Updates state of input when value is entered in the field
       * @param {Object} e
       */
      updateInput(e) {
        this.setState({
          input: e.target.value
        });
      }
      /**
       * Remove all items from the state list
       */
      handleClearAll() {
        this.setState({
          list: [],
          input:'',
        })
      }
      /**
       * Move item into wish list
       * @param {string} item
       */
      handleToDeactivate(item) {
        this.setState(currentState => {
          return {
            list: currentState.list.map(el => {
              return (el.name === item) ? {name: el.name, active: !el.active} : {name: el.name, active: el.active}
            })
          }
        });
      }

      render() {
        return (
        <div>
          <input type="text" placehoder="Enter product name" value={ this.state.input } onChange = { this.updateInput } />
          <button onClick = { this.handleAddItem }>Submit</button>
          <button onClick = { this.handleClearAll }>Clear all</button>
          <ShoppingList onRemoveItem = { this.handleRemoveItem } onDeactivateItem = { this.handleToDeactivate }
          list = { this.state.list } />
        </div>
        );
      }
    }

    function ShoppingList(props) {
      return (
        <div>
          <h2>Must buy products</h2>
          <ul>
          {
            props.list.map(item => {
              if (item.active == true) {
              return (<li key= { item.name }>
                <span>{ item.name }</span>
                <button onClick = { () => {props.onRemoveItem(item.name)} }>Remove</button>
                <button onClick = { () => {props.onDeactivateItem(item.name)} }>Deactivate</button>
              </li>
              )}
            })
          }
          </ul>
          <h2>Product wish to buy</h2>
          <ul>
          {
            props.list.map(item => {
              if (!item.active) {
                return (<li key= { item.name }>
                  <span> { item.name } </span>
                  <button>Remove</button>
                </li>)
              }
            })
          }
          </ul>
        </div>
      );
    }

    ReactDOM.render(
      <App />,
      document.getElementById('root')
    )
  </script>
</body>
</html>
